# Template file for 'lsp-plugins-lv2'
pkgname=lsp-plugins-lv2
version=1.1.30
revision=1
wrksrc=lsp-plugins-${version}
build_style=gnu-makefile
make_build_args="VERBOSE=1 PREFIX=/usr"
make_check_args=$make_build_args
make_install_target="install install_xdg"
make_use_env=yes
hostmakedepends="pkg-config php lv2 libsndfile-devel"
makedepends="libsndfile-devel libX11-devel libglvnd-devel lv2 cairo-devel
 ladspa-sdk jack-devel"
_desc="Collection of free audio plugins"
short_desc="${_desc} - LV2"
maintainer="Artur Sinila <freesoftware@logarithmus.dev>"
license="LGPL-3.0-or-later"
homepage="https://lsp-plug.in/"
distfiles="https://github.com/sadko4u/lsp-plugins/archive/refs/tags/${version}.tar.gz"
checksum=9cf43257729093c240375b3640b1514dff34b092b83b54a5ee68d7e8565c8f80

export SKIP_CC_LD_ARCH=yes
export HOST_BUILD_ARCH="${XBPS_MACHINE%-*}"
export HOST_PKG_CONFIG="$PKG_CONFIG_FOR_BUILD"
if [ -n "$CROSS_BUILD" ]; then
	export BUILD_ARCH="${XBPS_TARGET_MACHINE%-*}"
	export HOST_CXXFLAGS="$CXXFLAGS_host"
	export HOST_CXX="$CXX_host"
	export HOST_LD="$LD_host"
else
	export BUILD_ARCH="${XBPS_MACHINE%-*}"
	export HOST_CXXFLAGS="$BUILD_CXXFLAGS"
	export HOST_CXX="$BUILD_CXX"
	export HOST_LD="$BUILD_LD"
fi

lsp-plugins-jack_package() {
	short_desc="${_desc} - JACK"
	pkg_install() {
		vmove usr/bin
		vmove usr/lib/lsp-plugins/lsp-plugins-jack-core*
		vmove usr/lib/lsp-plugins/lsp-plugins-r3d-glx.so
		vmove usr/share/applications
		vmove usr/share/desktop-directories
		vmove usr/share/icons
		vmove etc/xdg/menus
	}
}

lsp-plugins-ladspa_package() {
	short_desc="${_desc} - LADSPA"
	pkg_install() {
		vmove usr/lib/ladspa/lsp-plugins-ladspa.so
	}
}

lsp-plugins-vst_package() {
	short_desc="${_desc} - VST"
	pkg_install() {
		vmove usr/lib/vst
	}
}

lsp-plugins_package() {
	short_desc="${_desc} - LV2, JACK, LADSPA, VST"
	depends="lsp-plugins-lv2 lsp-plugins-jack lsp-plugins-ladspa lsp-plugins-vst"
	build_style=meta
}

lsp-plugins-doc_package() {
	short_desc="${_desc} - documentation"
	pkg_install() {
		vmove usr/share/doc
	}
}
